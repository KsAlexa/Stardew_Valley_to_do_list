TODO: 
1. редактирование наименования тасок
2. добавить таскам кол-во дней на исполнение 1,2,5..постоянно (изменить type?)
3. добавить сущности для кадки, бочонка, бочки с отсчетом времени готовности (будет уменьшаться при перелистывании дня)

Идея проекта:

В проекте должны быть две основные сущности:

День (Day): Представляет собой запись о конкретном дне, который может быть установлен как активный. Дни имеют следующие атрибуты:
id: Уникальный идентификатор дня (автоинкремент).
year: Год, к которому относится день.
season: Сезон ('spring', 'summer', 'autumn', 'winter'). Значение по умолчанию для "нулевого дня" - 'undefined'.
number: Порядковый номер дня в сезоне.
active: Булево значение, указывающее, является ли день текущим активным днем.

Задача (Task): Представляет собой конкретную задачу, привязанную к определенному дню. Задачи включают:
id: Уникальный идентификатор задачи (автоинкремент).
name: Название задачи.
day_id: Внешний ключ, связывающий задачу с конкретным днем.
type: Тип задачи ('daily','one-time').
status: Статус задачи ('active', 'completed').

Структура Проекта
Проект организован по слоям для лучшей читаемости и поддерживаемости:
main.py: Главный файл Fastapi приложения. Содержит точку входа, инициализацию базы данных и регистрацию API-роутов. При запуске создает единственные экземпляры сервисов и сохраняет их в общем состоянии приложения.
dependencies.py: Содержит функции-"поставщики" для системы внедрения зависимостей FastAPI. Эти функции получают доступ к сервисам (DayService, TaskService), созданным при запуске приложения, и предоставляют их обработчикам API-запросов.
config.py: Файл для хранения общих настроек приложения, таких как путь к файлу базы данных (DB_PATH).
migration.py: Содержит функции для управления схемой базы данных, такие как создание таблиц (create_database_and_tables). Это гарантирует, что структура БД соответствует ожиданиям приложения при его запуске.
errors.py: Содержит определения пользовательских классов исключений для обработки ошибок в приложении.
entities.py: Определения классов Task, Day, которые представляют собой структуры данных (сущности), которые хранятся в базе данных.
repository.py: Слой доступа к данным. Содержит функции для выполнения CRUD-операций напрямую с базой данных SQLite.
service.py: Слой бизнес логики. Содержит основную логику приложения, взаимодействуя с репозиториями.
api/: Слой API. Отвечает за обработку HTTP-запросов и ответов.
api/error.handlers.py: Обработчики ошибок для API, преобразующие исключения в HTTP-ответы.
api/handlers_models: Определяет Pydantic модели для валидации данных в API-запросах и форматирования ответов.



Логика работы с днями:
Приложение реализовано с учетом следующих принципов управления днями:
Инициализация текущего дня: При каждом запуске приложения система сначала пытается найти активный день в базе данных. Если такой день найден, он становится текущим. Если активных дней нет(при первом запуске вообще никаких дней нет), то устанавливается первый активный день с параметрами: year = 1, season = 'spring', number = 1, active = True.
Управление активностью дня: В любой момент времени в базе данных может быть только один активный день (active = True). При переключении на новый день (будь то "следующий" день или конкретная дата), предыдущий активный день автоматически деактивируется.

Правила работы с задачами:
Задачи могут быть добавлены только к реальному, активному дню. Невозможно добавить задачи к любому другому неактивному дню.
При добавлении задачи мы передаем только название задачи, ее тип и статус изначально установлены как 'one-time' и 'active' соответственно.
Только задачу с type = 'one-time' можно пометить как завершенную: status = 'completed'.
Завершенную задачу можно вернуть в активную, status = 'active', тогда ее day_id поменяет свое значение на текущий активный день.

API Endpoints:
Проект будет предоставлять следующие API-ручки для взаимодействия:

GET /day/current: Получение информации о текущем активном/отображаемом дне (год, сезон, номер) и всех привязанных к нему задачах.

PUT /day/current: Установка конкретного дня как активного (по параметрам год, сезон, номер). Этот запрос может как активировать уже существующий день, так и создать новый, если его нет. Также деактивирует предыдущий активный день.

POST /day/next: Переключение текущего активного дня на следующий (увеличение номера дня на 1). Этот запрос деактивирует текущий день и активирует или создает следующий. При этом все задачи с type = 'daily' переходят в новый день (меняют свой day_id на текущий активный), а задачи с type = 'one-time' становятся завершенными(status = 'completed')

POST /task: Создание новой задачи, привязанной к текущему активному дню.

PATCH /task/{id}/complete Переводит задачу в завершенную (status = 'completed'). Завершить можно только задачу с type = 'one-time'

PATCH /task/{id}/active Возвращает задачу в из завершенной активную (status = 'active'). При этом меняет свой day_id на текущий активный день.

PATCH /task/{id}/daily Переводит задачу в ежедневную (type = 'daily'). Задачу с таким типом нельзя пометить как завершенную

PATCH /task/{id}/one_time Переводит задачу в однодневную (type = 'one_time').
